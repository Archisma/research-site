<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Archisma Ghosal â€“ Research</title>

  <style>
    :root{
      --bg:#0b1020;
      --panel:#111a33;
      --panel-soft:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.14);
      --text:#e9eeff;
      --muted:#aab6d6;
      --accent:#6aa6ff;
      --accent-soft:rgba(106,166,255,.15);
      --radius:16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 10% 10%, #17244a 0%, var(--bg) 55%),
        linear-gradient(180deg,#0e1530,var(--bg));
    }

    .container{max-width:1200px;margin:0 auto;padding:22px}

    .hero{
      text-align:center;
      background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius:22px;
      padding:26px 18px;
      box-shadow:0 20px 60px rgba(0,0,0,.3);
    }
    .hero h1{margin:0;font-size:42px}
    .hero p{margin:10px 0 0;color:var(--muted)}

    .grid{
      margin-top:18px;
      display:grid;
      grid-template-columns:1fr;
      gap:16px;
    }

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 18px 40px rgba(0,0,0,.35);
    }

    label{display:block;font-size:13px;color:var(--muted);margin:10px 0 6px}
    input,select,textarea{
      width:100%;
      background:rgba(0,0,0,.25);
      color:var(--text);
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
      outline:none;
    }
    input:focus,select:focus,textarea:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 3px var(--accent-soft);
    }

    .row{display:grid;grid-template-columns:1fr 300px;gap:12px}
    @media(max-width:700px){.row{grid-template-columns:1fr}}

    .section{
      margin-top:12px;
      padding:14px;
      background:var(--panel-soft);
      border:1px solid var(--border);
      border-radius:14px;
    }
    .section h2{margin:0;font-size:18px}

    .pill{
      display:inline-block;
      margin-left:8px;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      border:1px solid var(--border);
      color:var(--muted);
    }

    .helper{
      margin-top:8px;
      font-size:14px;
      color:var(--muted);
      line-height:1.45;
    }

    .chips{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media(max-width:520px){.chips{grid-template-columns:1fr}}

    .chip{
      padding:12px;
      border-radius:14px;
      background:rgba(255,255,255,.05);
      border:1px solid var(--border);
      cursor:pointer;
      transition:.12s ease;
    }
    .chip:hover{
      background:var(--accent-soft);
      border-color:var(--accent);
    }

    .buttons{
      display:flex;
      gap:12px;
      justify-content:center;
      margin-top:16px;
      flex-wrap:wrap;
    }
    button{
      min-width:170px;
      padding:12px 18px;
      border-radius:14px;
      border:none;
      font-weight:700;
      cursor:pointer;
      background:linear-gradient(180deg,#7bb1ff,#5a90ff);
      color:#08142f;
    }
    .ghost{
      background:rgba(255,255,255,.07);
      color:var(--text);
      border:1px solid var(--border);
    }

    textarea{
      margin-top:10px;
      min-height:200px;
      resize:vertical;
      line-height:1.5;
      font-family:ui-monospace,monospace;
    }

    .status{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
    }

    .footerInfo{
      margin-top:12px;
      padding-top:10px;
      border-top:1px solid var(--border);
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
    }

    .mono{font-family:ui-monospace,monospace}
  </style>
</head>

<body>
<div class="container">

  <div class="hero">
    <h1>Welcome to Archisma Ghosal's Research page</h1>
    <p>Please provide the item that you need to do the research.</p>
  </div>

  <div class="grid">
    <!-- MAIN -->
    <div class="card">
      <div class="row">
        <div>
          <label>Topic of research</label>
          <input id="topic" placeholder="e.g. Explain what RAG is in simple words"/>
        </div>
        <div>
          <label>Category of research</label>
          <select id="mode" onchange="updateMode()">
            <option value="public">Public (Internet)</option>
            <option value="confidential">Confidential (Internal)</option>
          </select>
        </div>
      </div>

      <div class="section">
        <h2 id="modeTitle">Public Search (Internet)
          <span class="pill" id="pill">â‰¤ 100 words</span>
        </h2>

        <p class="helper" id="helperText">
          Iâ€™m putting my researcher hat on â€” tell me what you want to research.<br/>
          <strong>Public search:</strong> Iâ€™ll return a result within <strong>100 words</strong>.
        </p>

        <div class="chips" id="chips"></div>
      </div>

      <div class="buttons">
        <button onclick="runResearch()">Run research</button>
        <button class="ghost" onclick="clearOutput()">Clear output</button>
      </div>

      <label style="margin-top:14px">Research Output</label>
      <textarea id="out" readonly></textarea>

      <div class="status">
        <span id="status">Status: Idle</span>
        <span class="mono" id="endpoint"></span>
      </div>

      <!-- INFO moved below, and NO backend URL exposed -->
      <div class="footerInfo" id="footerInfo">
        Public search uses live internet sources. Confidential search is limited to Aurora internal data.
      </div>
    </div>
  </div>
</div>

<script>
  // Keep API_BASE in code for fetch, but do not display it anywhere in UI.
  const API_BASE   = "https://archisma-research-backend.onrender.com";
  const PUBLIC_URL = API_BASE + "/public_search";
  const SEARCH_URL = API_BASE + "/search";

  const topicEl     = document.getElementById("topic");
  const outEl       = document.getElementById("out");
  const statusEl    = document.getElementById("status");
  const modeEl      = document.getElementById("mode");
  const endpointEl  = document.getElementById("endpoint");
  const modeTitleEl = document.getElementById("modeTitle");
  const helperTextEl= document.getElementById("helperText");
  const pillEl      = document.getElementById("pill");
  const chipsEl     = document.getElementById("chips");

  // Confidential samples (Aurora-only) â€” NO "go beyond"
  const confidentialSamples = [
    "List the major HR policies mentioned in the Aurora policy manual.",
    "According to the policy manual, what rules exist about remote or hybrid work?",
    "Summarize Aurora Systems' code of conduct and disciplinary process.",
    "What is the leave policy (PTO/sick leave) described in the policy manual?",
    "What are the security and data handling rules for employees?",
    "Summarize Aurora Systems' strategic pillars and long-term goals.",
    "What are the top strategic initiatives for the next 3 years?",
    "Show revenue by quarter for 2023 and summarize the trend.",
    "What is the trend of R&D spend by quarter in 2023?",
    "Compare gross margin % across 2023 quarters and summarize the trend."
  ];

  // Public samples â€” WITH "researcher hat" message + examples + "go beyond"
  const publicSamples = [
    "How is the weather today in New York?",
    "What is the stock price of Apple today?",
    "Summarize today's top technology news headlines.",
    "What are the latest updates in AI this week?",
    "Explain what RAG is in simple words.",
    "Give me a travel plan for a 2-day trip to Boston.",
    "What is the current price of Bitcoin?",
    "Find recent updates about OpenAI products.",
    "What are the best free cloud hosting options for small apps?",
    "What is the latest NVIDIA earnings summary?"
  ];

  function setTopic(t){ topicEl.value=t; topicEl.focus(); }
  function clearOutput(){ outEl.value=""; statusEl.textContent="Status: Idle"; }

  function trim100(text){
    const cleaned = String(text || "").trim();
    if(!cleaned) return "";
    const w = cleaned.split(/\s+/);
    return w.length<=100 ? cleaned : w.slice(0,100).join(" ")+" â€¦";
  }

  function renderChips(list){
    chipsEl.innerHTML = "";
    list.forEach(t=>{
      const d=document.createElement("div");
      d.className="chip";
      d.textContent=t;
      d.onclick=()=>setTopic(t);
      chipsEl.appendChild(d);
    });
  }

  function updateMode(){
    const isPublic = modeEl.value==="public";

    if(isPublic){
      // Keep the first text node update safe:
      modeTitleEl.childNodes[0].textContent = "Public Search (Internet) ";
      pillEl.textContent = "â‰¤ 100 words";
      helperTextEl.innerHTML =
        "Iâ€™m putting my researcher hat on â€” tell me what you want to research.<br/>" +
        "Also: Iâ€™m a tiny baby-researcher ðŸ‘¶ðŸ”Ž so Iâ€™ll keep it simple and short.<br/>" +
        "<strong>Public search:</strong> Iâ€™ll return a result within <strong>100 words</strong>. " +
        "You can go beyond these examples.";
      endpointEl.textContent = "/public_search";
      renderChips(publicSamples);
    } else {
      modeTitleEl.childNodes[0].textContent = "Confidential Search ";
      pillEl.textContent = "Internal docs";
      helperTextEl.innerHTML =
        "Confidential research uses your internal Aurora knowledge base.<br/>" +
        "Also: Iâ€™m a tiny baby-researcher ðŸ‘¶ðŸ“„ so Iâ€™ll keep it simple and focused.<br/>" +
        "<strong>Note:</strong> Aurora-only topics â€” no public web searching in this mode.";
      endpointEl.textContent = "/search";
      renderChips(confidentialSamples);
    }
  }

  updateMode();

  async function runResearch(){
    const topic = topicEl.value.trim();
    if(!topic){ outEl.value="Please enter a topic."; return; }

    statusEl.textContent="Status: Runningâ€¦";
    outEl.value="Running researchâ€¦";

    const isPublic = modeEl.value==="public";
    const url  = isPublic ? PUBLIC_URL : SEARCH_URL;
    const body = isPublic ? { topic } : { query: topic };

    try{
      const r=await fetch(url,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(body)
      });

      if(!r.ok){
        const text = await r.text();
        throw text || ("HTTP " + r.status);
      }

      const data = await r.json();
      const answer = data.answer || JSON.stringify(data,null,2);

      outEl.value = isPublic ? trim100(answer) : answer;
      statusEl.textContent="Status: Done";
    }catch(e){
      outEl.value="Error:\n"+(e && e.message ? e.message : String(e));
      statusEl.textContent="Status: Error";
    }
  }
</script>
</body>
</html>
